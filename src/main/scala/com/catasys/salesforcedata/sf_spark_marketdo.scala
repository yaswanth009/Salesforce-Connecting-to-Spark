package com.catasys.salesforcedata

/**
  * Created by yalla on 9/14/2017.
  */

import org.apache.log4j.Logger
import org.apache.log4j.Level

import org.apache.spark.sql.SparkSession
import org.apache.spark.sql.SparkSession
import org.apache.spark.sql.functions.{col, _}
import org.apache.spark.sql.types._
import com.springml.spark.salesforce

import org.json4s._
import org.json4s.jackson.JsonMethods._

import scala.util.control.NonFatal
import org.apache.spark.rdd.RDD
import scala.tools.nsc.typechecker.Macros

object sf_spark_marketdo {

  def main(args: Array[String]): Unit = {

    val spark = SparkSession.builder.master("local[*]").appName("sf_spark_marketdo")
                .master("local[*]")
              //.enableHiveSupport()
                .getOrCreate()




    val soql = "SELECT Account_Name_for_Letters__c,Account_Subaccount__c,Account__c,AM_Time__c,Carrier_Name__c,Catasys_Fee_PMPM_Equiv__c,Center_Status__c,CreatedById,CreatedDate,Disclaimer_Text_Reverse__c,Disclaimer_Text__c,EnrolledMemberCTD__c,Enrolled_Member_800_Number__c,Env_Text_Primary_v1__c,Env_Text_Primary_v2__c,Env_Text_Primary_v3__c,Env_Text_Secondary_v1__c,Env_Text_Secondary_v2__c,Env_Text_Secondary_v3__c,HealthPlanCTD__c,Health_Plan_Call_In_Number__c,Id,IsDeleted,LastActivityDate,LastModifiedById,LastModifiedDate,LastReferencedDate,LastViewedDate,Letter_Languages__c,Letter_Layout__c,Name,OutreachMemberCTD__c,Outreach_800_Number_Legacy__c,OwnerId,PM_Time__c,Population_Covered__c,Program_Scope__c,ROI_BH1__c,ROI_BH2__c,ROI_HP2__c,Service_Center_Short_Name__c,StayOnTrak_URL__c,SysAdmin_Static_Copay_Required__c,SysAdmin_Static_Mail_Cycle__c,SysAdmin_Static_Owner__c,SysAdmn_Mbr_Acct_ID__c,SysAdmn_Static_Referral_Source__c,SystemModstamp,Time_Zone_GMT_Offset__c,Time_Zone__c,X800_Number__c FROM Service_Center__c"


    val sf_Service_Center__c =  spark.read.format("com.springml.spark.salesforce")
                .option("username", "yalla@catasys.com")
                .option("password", "Mango009$Dm0FCfXPsvr6WHFqxDMCRfY1")
                .option("soql", soql)
                .option("version", "32.0")
                .load()

    //sf_Service_Center__c.show()

   // sf_Service_Center__c.write.mode("append").saveAsTable("SalesForce.Service_Center__c")

   // val sf_SD_Member_c = "SELECT Account_Subaccount__c,Account__c,Address_2__c,Address_Bad__c,Address_Selector__c,Address__c,Admission_Risk_Contact__c,Admission_Risk_Decision_Date__c,Admission_Risk_Status__c,Age_SD_Member__c,Anxiety_History__c,Anxiety_P12M__c,Avg_Length_of_Stay_days__c,A_List__c,Bad_HP_Address_2__c,Bad_HP_Address__c,Bad_HP_City__c,Bad_HP_State__c,Bad_HP_Zip__c,Bad_NCOA_Address__c,Bad_NCOA_City__c,Bad_NCOA_State__c,Bad_NCOA_Zip__c,Bad_Pref_Adrs_Address2__c,Bad_Pref_Adrs_Address__c,Bad_Pref_Adrs_City__c,Bad_Pref_Adrs_State__c,Bad_Pref_Adrs_Zip__c,Base_Period_Days_Eligible__c,Base_Period_Total_Cost__c,Bonus_Eligible_Member__c,Bonus_Paid_Date__c,Bounced_Email_Address__c,Bounced_Email_Date__c,call_Notes_backup_12_25_2016__c,Call_Notes__c,Call_No_Mail__c,CareCoach_IsActive__c,CareCoach_Title__c,CareCoach__c,Carrier_Member_ID__c,CaseManagerCTD__c,Case_Manager_Company_Name__c,Case_Manager_Email__c,Case_Manager_Name__c,Case_Manager_Phone__c,Catasys_Bill_Payer__c,Catasys_External_ID_v02__c,Catasys_External_ID__c,Catasys_Medical_Exclusion_Status__c,Catasys_Product__c,Catasys_Stops_Letter_b_c_Low_Cost__c,Catasys_Stops_Phone_Follow_Ups__c,CCC_Outreach_Eligible__c,CC_Status_Age__c,CC_Status_Date_Change__c,CDR_EAP_Name__c,CellPhoneCTD__c,Cell_Phone_2__c,Cell_Phone_Opt_Out__c,Cell_Phone__c,Centene_Childless_Adult__c,Centene_Clinical_Severity_Level__c,City__c,Clinical_Comments__c,Clinical_Flag__c,CM_Anxiety__c,CM_Asthma__c,CM_Bipolar__c,CM_CAD__c,CM_Cancer__c,CM_CHF__c,CM_Chronic_Pain__c,CM_COPD__c,CM_Depression__c,CM_DM__c,CM_ESRD__c,CM_Hypertension__c,CM_Selected_Comorbids_Count__c,CM_SUD__c,Comorbid_Conditions__c,Copay_Required__c,Cost_Share_Coinsurance__c,Cost_Share_Copay_ER__c,Cost_Share_Copay_Facility__c,Cost_Share_Copay_PCP__c,Cost_Share_Copay_Specialist__c,Cost_Share_Deductible_Indiv__c,Cost_Share_Out_Of_Pocket_Max__c,Counter_Unique_Record__c,Country__c,Count_P10M_7_5k__c,Coventry_Migration_New_Aetna_ID__c,CreatedById,CreatedDate,Date_of_Birth__c,DELETE_ME_Temp_Flag__c,Demographic_Ranking_2__c,Demographic_Ranking_n__c,Demographic_Ranking__c,Demographic_Rank_Input_Raw__c,Disenrollment_Date_First_OnTrak__c,Disenrollment_Date_Latest_OnTrak__c,Drugs_All_Alcohol__c,Drugs_All_Combinations__c,Drugs_All_Opiates__c,Drugs_All_Other__c,Drugs_All_Stim__c,Drugs_of_Choice_All__c,Drugs_of_Choice_P12M__c,Dual_Eligible__c,DW_Load_Date__c,Effective_Date__c,Eligible_Flag__c,Email_Address_Extra_1__c,Email_Address__c,Email_Counter__c,Email_Opt_Out__c,Enrollment_Date_First_OnTrak__c,Enrollment_Date_Latest_OnTrak_old__c,Enrollment_Date_Latest_OnTrak__c,Enrollment_Location_Number__c,Enrollment_Progress_Status__c,EnrollMessage_TEST__c,EnrollMessage__c,Enroll_Dis_Grad_Dates_Count_OnTrak__c,Envelope_Type__c,eOnTrak_ID__c,eRehab_ID__c,ER_Visits__c,Ethnicity__c,Exception_Contact_OLD__c,First_Name__c,First_Provider_Visit_Date__c,Full_Name_02__c,Full_Name__c,Gender__c,Graduation_Date_Last_OnTrak__c,Group_Name__c,Group_Number__c,HDP__c,HEDIS_Enrollment_Window__c,HEDIS_Index_Date_OLD__c,HEDIS_Index_Date__c,HEDIS_Initiation_Date__c,HomePhoneCTD__c,Home_Phone_2__c,Home_Phone_Opt_Out__c,Home_Phone__c,HP_Address_Verification__c,Humana_AMC_Pilot__c,Humana_Embargoed__c,Humana_Fin_Market_Desc__c,Humana_HCCP_90_Day__c,Humana_HCCP_Status__c,Humana_Healthsense_Pilot__c,Humana_Level_of_Intervention__c,Humana_Okay_to_Outreach__c,Humana_Test_Leg__c,Humana_VRI_Pilot__c,HUSD_OnTrak_Outreach_Candidate__c,HUSD_Triggering_End_Date__c,HUSD_Triggering_Impactable_Cost__c,HUSD_Triggering_SD_Cost__c,HUSD_Triggering_Total_Cost__c,Id,ID2__c,Ins_Card_ID_Member__c,Ins_ID_Member__c,Ins_ID_Secondary_Member__c,Ins_ID_Suscriber__c,Internal_Member_ID__c,In_patient_admits__c,IP_Days__c,IsDeleted,Language_Preferred__c,Language__c,LastActivityDate,LastModifiedById,LastModifiedDate,LastReferencedDate,LastViewedDate,Last_Address_Fail_Date__c,Last_Address_Fail_Error__c,Last_Hospital_DX__c,Last_Hospital_Treatment_Date__c,Last_Hospital_Treatment__c,Last_Name__c,Last_Non_SD_IP_Discharge_del__c,Last_SD_IP_discharge_del__c,Last_treated_for_SD__c,Letter_Counter__c,Lost_Contact_Follow_Up__c,Low_Performer__c,Mailing_Address_2__c,Mailing_Address_Combined__c,Mailing_Address__c,Mailing_City__c,Mailing_Cycle_Index__c,Mailing_Cycle__c,Mailing_First_Name_02__c,Mailing_First_Name__c,Mailing_State__c,Mailing_Zip__c,Mail_Returned_Date__c,Mail_Returned_Message__c,Make_1st_Follow_Up_Call__c,Make_2nd_Follow_Up_Call__c,Make_3rd_Follow_Up_Call__c,Master_Status__c,Medicaid_ID_Member__c,Medicaid_Subgroup__c,Member_Deidentified_ID__c,Member_Eligibility_Status__c,Member_MBHO_ID__c,Middle_Name__c,Name,NCOA_Address_Verification__c,NCOA_Address__c,NCOA_Adrs_Last_Edit_Date__c,NCOA_City__c,NCOA_Error_Code__c,NCOA_Error_Description__c,NCOA_State__c,NCOA_Zip__c,No_Phone_on_File__c,Number_of_Denary_SD_Diagnosis__c,Number_of_Nonary_SD_Diagnosis__c,Number_of_Octonary_SD_Diagnosis__c,Number_of_Primary_SD_Diagnosis__c,Number_of_Quarternary_SD_Diagnosis__c,Number_of_Quinary_SD_Diagnosis__c,Number_of_SD_Diagnoses_P12M_Total__c,Number_of_Secondary_SD_Diagnosis__c,Number_of_Senary_SD_Diagnosis__c,Number_of_Septenary_SD_Diagnosis__c,Number_of_Tertiary_SD_Diagnosis__c,Number_of_Treatments_for_SD__c,OK_to_Call__c,Opt_Out_Date_Most_Recent__c,Opt_out_Reason__c,Outreach_Priority__c,Outreach_Tier__c,OwnerId,Owner_email__c,Owner_First_Name__c,Owner_ID__c,Owner_IsActive__c,Owner_Last_Name__c,Owner_Phone__c,Owner_Role__c,P2Y_Days_Eligible__c,P2Y_End_Date__c,P2Y_Impactable_Cost__c,P2Y_SD_Cost__c,P2Y_Total_Cost__c,P3Y_Days_Eligible__c,P3Y_End_Date__c,P3Y_Impactable_Cost__c,P3Y_SD_Cost__c,P3Y_Total_Cost__c,P10M_Days_Eligible__c,P10M_End_Date__c,P10M_Impactable_Cost__c,P10M_SD_Cost__c,P10M_SD_Level__c,P10M_Total_Cost__c,P12M_Days_Eligible__c,P12M_End_Date__c,P12M_Impactable_Cost__c,P12M_SD_Cost__c,P12M_SD_Level__c,P12M_Total_Cost__c,PCP_NPI_Number__c,PCP_Plan_ID__c,Phone_Call_Eligible_02__c,Phone_Call_Eligible__c,Phone_Extra_1__c,Phone_Extra_2__c,Phone_Extra_3__c,Phone_Extra_4__c,Phone_Extra_5__c,Phone_Extra_6__c,Phone_Extra_7__c,Phone_Last_Research_Date__c,Plan_Type_Generic__c,Plan_Type_HP_Name__c,Population_Type__c,Post_Referral_to_CC_Status__c,Post_Referral_to_CC_Sub_Status__c,Potential_Duplicate_from_Source__c,PrefCellCTD__c,PrefHomeCTD__c,PrefPhoneCTD__c,PrefWorkCTD__c,Pref_Address2__c,Pref_Address_Verification__c,Pref_Address__c,Pref_Adrs_Last_Edit_Date__c,Pref_Cell_Phone_2__c,Pref_Cell_Phone__c,Pref_City__c,Pref_Email__c,Pref_Home_Phone_2__c,Pref_Home_Phone__c,Pref_Name__c,Pref_Phone_2__c,Pref_Phone__c,Pref_State__c,Pref_Work_Phone_2__c,Pref_Work_Phone__c,Pref_Zip__c,printsf_Last_Returned_Mail_Date__c,Psych_Comorbidity__c,Race__c,Ranking_Receptivity_n__c,Ranking_Receptivity__c,Receives_Family_Letter__c,Record_Invalid__c,ReferralSourceCTD__c,Referral_Date__c,Referral_Source_Email__c,Referral_Source_Name__c,Referral_Source_Phone__c,Referral_Source__c,Relationship_Dependent__c,Relationship_Spouse__c,Relationship_Subscriber__c,Relationship_to_the_Subcriber__c,Relationship_Unknown__c,ROI_Additional_Family_Mbr_Relation__c,ROI_Additional_Family_Mbr_Support_Prsn__c,ROI_Additional_Phone__c,ROI_Family_Member_Support_Person_Phone__c,ROI_Family_Member_Support_Person__c,ROI_Family_Member_Support_Relation__c,ROI_Hospitals_Phone__c,ROI_Hospitals__c,ROI_Other_Info__c,ROI_Other_Phone__c,ROI_Other_Purpose__c,ROI_Other_Relation__c,ROI_Other__c,ROI_PCP_Phone__c,ROI_PCP__c,ROI_Pharmancy_s_Phone__c,ROI_Pharmancy_s__c,ROI_Relationship_Other_Notes__c,rpt800__c,rptCareCoach_First_Name__c,rptCareCoach_Last_Name__c,rptEligibles__c,rptEnrolles__c,rptURL__c,SDMD_Appointment__c,Send_Case_Manager_Clinical_Summaries__c,Send_Monthly_Letter__c,Service_Center__c,Soft_Enrollment__c,Special_Field_1__c,Special_Field_2__c,State__c,Stationery_Type__c,Subscriber_First_Name__c,Subscriber_Last_Name__c,Subscriber_Middle_Name__c,SystemModstamp,System_Admin_Assessment_in_Progress__c,System_Admin_in_STCC_Process__c,System_Admin_OnTrak_Calls_OK_TEST__c,System_Admin_OnTrak_Calls_OK__c,System_Admin_OnTrak_Email_OK__c,System_Admin_OnTrak_US_Mail_OK_TEST_Em2__c,System_Admin_OnTrak_US_Mail_OK_TEST_Eml__c,System_Admin_OnTrak_US_Mail_OK_TEST__c,System_Admin_OnTrak_US_Mail_OK__c,System_Admin_Post_RefCC_Low_Cost__c,System_Admin_Test_Record__c,System_Admin_Training_Record__c,Termination_Date_Last_OnTrak__c,Termination_Date_OnTrak__c,Termination_Date__c,TestField1__c,TestPhoneCTD__c,Test_Leg_Hidden__c,Test_Leg__c,Test_Phone__c,Time_Zone__c,Total_Opt_out__c,Treatment_Module_Anxiety__c,Treatment_Module_Depression__c,Treatment_Module_Live_Healthy__c,Treatment_Module_Multiple_Conditions__c,Treatment_Module_Pain__c,Treatment_Module_Smoking__c,Treatment_Module_SUD__c,Treatment_Module_Weight__c,Treatment_Module__c,US_Mail_Opt_out__c,Visual_Profile__c,Voucher_Based_Reimbursement__c,WorkPhoneCTD__c,Work_Location__c,Work_Phone_2__c,Work_Phone_Opt_out__c,Work_Phone__c,Zip__c FROM SD_Member__c"


  }

}
